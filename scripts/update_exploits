#!/usr/bin/env python
"""
file: main
author: adh
created_at: 6/28/21 2:57 PM
"""
import os
import logging

from git_vul_driller.repo_drill_common import main as repo_driller
from git_vul_driller.repo_drill_common import formatter

# set up logging
logger = logging.getLogger()
logger.setLevel(logging.DEBUG)

# create console handler with a higher log level
# add the handlers to the logger
ch = logging.StreamHandler()
ch.setLevel(logging.INFO)
ch.setFormatter(formatter)
logger.addHandler(ch)

cfg_files = {
    "exploit_db": "config_edb.yaml",
    "metasploit": "config_metasploit.yaml",
}


def main():
    for key, cfg_file in cfg_files.items():
        kwargs = {"cfgpath": os.path.abspath(cfg_file)}
        logger.info(f"Processing {key}")
        repo_driller(kwargs)

    pass


if __name__ == "__main__":
    main()
